<!DOCTYPE html>
<html>
  <head>
    <title>AR View with a Spinning Cube</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
      body { margin: 0; overflow: hidden; }
      canvas { width: 100vw; height: 100vh; display: block; }
      #coordinates { position: absolute; top: 0; left: 0; padding: 10px; font-size: 16px; font-weight: bold; color: #fff; background-color: rgba(0,0,0,0.5); }
    </style>
  </head>
  <body>
    <canvas id="canvas"></canvas>
    <div id="coordinates"></div>
    <script src="https://cdn.jsdelivr.net/npm/three@0.131.2/build/three.min.js"></script>
    <script>
      const canvas = document.getElementById('canvas');
      const coordinatesDiv = document.getElementById('coordinates');

      // Set up the Three.js renderer and attach it to the canvas
      const renderer = new THREE.WebGLRenderer({ canvas, alpha: true });
      renderer.setClearColor(0x000000, 0);

      // Set up the Three.js scene
      const scene = new THREE.Scene();

      // Set up the Three.js camera
      const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);

      // Set up the Three.js light
      const light = new THREE.PointLight(0xffffff, 1, 100);
      light.position.set(0, 0, 50);
      scene.add(light);

      // Set up the Three.js spinning cube
      const cube = new THREE.Mesh(
        new THREE.BoxGeometry(10, 10, 10),
        new THREE.MeshLambertMaterial({ color: 0xff0000 })
      );
      cube.position.set(0, 0, -5);
      scene.add(cube);

      // Set up the Three.js AR tracking
      const arToolkitSource = new THREEx.ArToolkitSource({ sourceType: 'webcam' });
      arToolkitSource.init(() => {
        // Resize the canvas to match the video source
        const cameraWidth = arToolkitSource.domElement.videoWidth;
        const cameraHeight = arToolkitSource.domElement.videoHeight;
        canvas.width = cameraWidth;
        canvas.height = cameraHeight;
        camera.aspect = cameraWidth / cameraHeight;
        camera.updateProjectionMatrix();
      });

      const arToolkitContext = new THREEx.ArToolkitContext({ cameraParametersUrl: 'https://raw.githubusercontent.com/nicolocarpignoli/nicolocarpignoli.github.io/main/marker-detector/camera_para.dat', detectionMode: 'mono' });
      arToolkitContext.init(() => {
        // Set up the Three.js AR marker
        const markerControls = new THREEx.ArMarkerControls(arToolkitContext, camera, {
          type: 'pattern',
          patternUrl: 'https://raw.githubusercontent.com/nicolocarpignoli/nicolocarpignoli.github.io/main/marker-detector/pattern-marker.patt',
          changeMatrixMode: 'cameraTransformMatrix'
        });
        scene.visible = camera.visible;

        // Render the scene
        function render() {
          requestAnimationFrame(render);
          if (arToolkitSource.ready !== false) {
            arToolkitContext.update(arToolkitSource.domElement
