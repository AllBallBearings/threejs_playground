<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AlvaAR Example</title>
    <script src="helper_scripts/alva_ar.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  </head>
  <body>
    <video id="video" autoplay></video>
    <canvas id="canvas"></canvas>
    <script>
      (async () => {
        const video = document.getElementById("video");
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");
        const width = 640;
        const height = 480;

        canvas.width = width;
        canvas.height = height;

        // Access the device camera
        const stream = await navigator.mediaDevices.getUserMedia({
          video: { width, height },
        });
        video.srcObject = stream;

        // Initialize AlvaAR
        const alva = await AlvaAR.Initialize(width, height);

        // Process each video frame
        const processFrame = () => {
          ctx.drawImage(video, 0, 0, width, height);
          const frame = ctx.getImageData(0, 0, width, height);
          const cameraPose = alva.findCameraPose(frame);
          // Use cameraPose for rendering 3D objects with Three.js
          requestAnimationFrame(processFrame);
        };

        video.addEventListener("play", processFrame);
      })();
    </script>
  </body>
</html>
